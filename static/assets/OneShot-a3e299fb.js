import{b5 as e,r as n}from"./vendor-49fe4ba3.js";import{s as b,A as l,R as c,Q as oe,a as re,b as x,c as ie,d as le}from"./index-2a6e401b.js";import{E as ce,d as de}from"./fluentui-icons-648b7c9b.js";import{S as D,h as he,b as pe,i as ue,e as me,D as xe,j as ge,T as g,f as ve,C as L,g as Se}from"./fluentui-react-0ee19e52.js";const Ce=({error:r,onRetry:o})=>e.jsxs(D,{className:b.answerContainer,verticalAlign:"space-between",children:[e.jsx(ce,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(D.Item,{grow:!0,children:e.jsx("p",{className:b.answerText,children:r})}),e.jsx(he,{className:b.retryButton,onClick:o,text:"Retry"})]}),Te="_oneshotContainer_1x7b2_1",_e="_oneshotTopSection_1x7b2_15",ye="_oneshotBottomSection_1x7b2_29",fe="_oneshotTitle_1x7b2_49",je="_oneshotQuestionInput_1x7b2_77",be="_oneshotAnswerContainer_1x7b2_91",Re="_oneshotAnalysisPanel_1x7b2_105",Ae="_oneshotSettingsSeparator_1x7b2_115",ke="_settingsButton_1x7b2_123",a={oneshotContainer:Te,oneshotTopSection:_e,oneshotBottomSection:ye,oneshotTitle:fe,oneshotQuestionInput:je,oneshotAnswerContainer:be,oneshotAnalysisPanel:Re,oneshotSettingsSeparator:Ae,settingsButton:ke},Ne="_examplesNavList_v5q0z_1",Pe="_example_v5q0z_1",we="_exampleText_v5q0z_53",R={examplesNavList:Ne,example:Pe,exampleText:we},Be=({text:r,value:o,onClick:i})=>e.jsx("div",{className:R.example,onClick:()=>i(o),children:e.jsx("p",{className:R.exampleText,children:r})}),Ee=[{text:"What is included in my Northwind Health Plus plan that is not in standard?",value:"What is included in my Northwind Health Plus plan that is not in standard?"},{text:"What happens in a performance review?",value:"What happens in a performance review?"},{text:"What does a Product Manager do?",value:"What does a Product Manager do?"}],He=({onExampleClicked:r})=>e.jsx("ul",{className:R.examplesNavList,children:Ee.map((o,i)=>e.jsx("li",{children:e.jsx(Be,{text:o.text,value:o.value,onClick:r})},i))}),De="_container_1k5c7_1",Le={container:De},Ie=({className:r,onClick:o})=>e.jsxs("div",{className:`${Le.container} ${r??""}`,onClick:o,children:[e.jsx(de,{}),e.jsx(pe,{children:"Developer settings"})]});function Ve(){const[r,o]=n.useState(!1),[i,I]=n.useState(l.RetrieveThenRead),[v,V]=n.useState(""),[S,M]=n.useState(""),[C,O]=n.useState(""),[h,Q]=n.useState(c.Hybrid),[A,q]=n.useState(3),[T,U]=n.useState(!0),[k,W]=n.useState(!1),[N,F]=n.useState(""),_=n.useRef(""),[y,P]=n.useState(!1),[p,w]=n.useState(),[u,$]=n.useState(),[B,E]=n.useState(),[m,d]=n.useState(void 0),f=async t=>{_.current=t,p&&w(void 0),P(!0),E(void 0),d(void 0);try{const s={question:t,approach:i,overrides:{promptTemplate:v.length===0?void 0:v,promptTemplatePrefix:S.length===0?void 0:S,promptTemplateSuffix:C.length===0?void 0:C,excludeCategory:N.length===0?void 0:N,top:A,retrievalMode:h,semanticRanker:T,semanticCaptions:k}},H=await le(s);$(H)}catch(s){w(s)}finally{P(!1)}},z=(t,s)=>{V(s||"")},G=(t,s)=>{M(s||"")},K=(t,s)=>{O(s||"")},X=(t,s)=>{q(parseInt(s||"3"))},J=(t,s,H)=>{Q((s==null?void 0:s.data)||c.Hybrid)},Y=(t,s)=>{I((s==null?void 0:s.key)||l.RetrieveThenRead)},Z=(t,s)=>{U(!!s)},ee=(t,s)=>{W(!!s)},te=(t,s)=>{F(s||"")},se=t=>{f(t)},ae=t=>{B===t&&m===x.CitationTab?d(void 0):(E(t),d(x.CitationTab))},j=t=>{d(m===t?void 0:t)},ne=[{key:l.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:l.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:l.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return e.jsxs("div",{className:a.oneshotContainer,children:[e.jsxs("div",{className:a.oneshotTopSection,children:[e.jsx(Ie,{className:a.settingsButton,onClick:()=>o(!r)}),e.jsx("h1",{className:a.oneshotTitle,children:"Ask your data"}),e.jsx("div",{className:a.oneshotQuestionInput,children:e.jsx(oe,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:y,onSend:t=>f(t)})})]}),e.jsxs("div",{className:a.oneshotBottomSection,children:[y&&e.jsx(ue,{label:"Generating answer"}),!_.current&&e.jsx(He,{onExampleClicked:se}),!y&&u&&!p&&e.jsx("div",{className:a.oneshotAnswerContainer,children:e.jsx(re,{answer:u,onLikeDislikeClicked:()=>{},onCitationClicked:t=>ae(t),onThoughtProcessClicked:()=>j(x.ThoughtProcessTab),onSupportingContentClicked:()=>j(x.SupportingContentTab)})}),p?e.jsx("div",{className:a.oneshotAnswerContainer,children:e.jsx(Ce,{error:p.toString(),onRetry:()=>f(_.current)})}):null,m&&u&&e.jsx(ie,{className:a.oneshotAnalysisPanel,activeCitation:B,onActiveTabChanged:t=>j(t),citationHeight:"600px",answer:u,activeTab:m})]}),e.jsxs(me,{headerText:"Configure answer generation",isOpen:r,isBlocking:!1,onDismiss:()=>o(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(xe,{onClick:()=>o(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(ge,{className:a.oneshotSettingsSeparator,label:"Approach",options:ne,defaultSelectedKey:i,onChange:Y}),(i===l.RetrieveThenRead||i===l.ReadDecomposeAsk)&&e.jsx(g,{className:a.oneshotSettingsSeparator,defaultValue:v,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:z}),i===l.ReadRetrieveRead&&e.jsxs(e.Fragment,{children:[e.jsx(g,{className:a.oneshotSettingsSeparator,defaultValue:S,label:"Override prompt prefix template",multiline:!0,autoAdjustHeight:!0,onChange:G}),e.jsx(g,{className:a.oneshotSettingsSeparator,defaultValue:C,label:"Override prompt suffix template",multiline:!0,autoAdjustHeight:!0,onChange:K})]}),e.jsx(ve,{className:a.oneshotSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:A.toString(),onChange:X}),e.jsx(g,{className:a.oneshotSettingsSeparator,label:"Exclude category",onChange:te}),e.jsx(L,{className:a.oneshotSettingsSeparator,checked:T,label:"Use semantic ranker for retrieval",onChange:Z}),e.jsx(L,{className:a.oneshotSettingsSeparator,checked:k,label:"Use query-contextual summaries instead of whole documents",onChange:ee,disabled:!T}),e.jsx(Se,{className:a.oneshotSettingsSeparator,label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:h==c.Hybrid,data:c.Hybrid},{key:"vectors",text:"Vectors",selected:h==c.Vectors,data:c.Vectors},{key:"text",text:"Text",selected:h==c.Text,data:c.Text}],required:!0,onChange:J})]})]})}Ve.displayName="OneShot";export{Ve as Component};
//# sourceMappingURL=OneShot-a3e299fb.js.map
